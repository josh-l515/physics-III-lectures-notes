name: Build LaTeX and Deploy to docs/

on:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up LaTeX environment
        uses: dante-ev/latex-action@v2
        with:
          root_file: main.tex
          working_directory: .
          compiler: latexmk
          args: "-pdf -interaction=nonstopmode -shell-escape"

      - name: Move PDF to docs/
        run: |
          mkdir -p docs
          cp main.pdf docs/

      - name: Create simple HTML viewer
        run: |
          echo '<!DOCTYPE html>
          <html lang="en">
          <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Physics III Lecture Notes</title>
            <style>
              html,body { margin:0; height:100%; background:#1e1e1e; }
              embed { display:block; width:100%; height:100vh; border:none; }
              .topbar { position:fixed; top:0; left:0; width:100%; background:#222; color:#fff;
                        font-family:sans-serif; padding:8px 16px; box-shadow:0 2px 5px rgba(0,0,0,0.3);}
              .topbar a { color:#4fc3f7; text-decoration:none; margin-left:10px;}
            </style>
          </head>
          <body>
            <div class="topbar">
              ðŸ“˜ <b>Physics III Lecture Notes</b> â€” <a href="main.pdf" download>Descargar PDF</a>
            </div>
            <embed src="main.pdf" type="application/pdf">
          </body>
          </html>' > docs/index.html

      - name: Commit and push docs
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "41898282+github-actions[bot]@users.noreply.github.com"
          git add docs
          git commit -m "Auto-update PDF in docs [skip ci]" || echo "No changes to commit"
          git push
